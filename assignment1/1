/Users/pengli/PycharmProjects/cs224n/assignment1/.env/bin/python /Users/pengli/PycharmProjects/cs224n/assignment1/q3_word2vec.py
Testing normalizeRows...
[[ 0.6         0.8       ]
 [ 0.4472136   0.89442719]]

sampleTokenIdx 2
random contxt ('b', ['e', 'a', 'c', 'c', 'd', 'd', 'd', 'c', 'c', 'b'])
dummy_vectors [[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
==== Gradient check for skip-gram ====
grad in check
[[ 0.          0.          0.        ]
 [ 0.          0.          0.        ]
 [ 0.          0.          0.        ]
 [ 0.06604866  1.35039694 -0.36755136]
 [ 0.          0.          0.        ]
 [-0.12831928 -0.06149283 -0.17591287]
 [-0.18052584 -0.08651113 -0.24748284]
 [-0.29759243 -0.14261148 -0.40796941]
 [ 0.23443245  0.11234412  0.32138341]
 [ 0.37200509  0.17827133  0.50998171]]
x
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x pos
[[-0.96725714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96745714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (0, 0) f_p 3.57312840491 f_n 3.57312840491 numgrad 0.0 grad[ix] 0.0
x pos
[[-0.96735714 -0.02172641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96735714 -0.02192641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (0, 1) f_p 3.59794527072 f_n 3.59794527072 numgrad 0.0 grad[ix] 0.0
x pos
[[-0.96735714 -0.02182641  0.25257529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96735714 -0.02182641  0.25237529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (0, 2) f_p 2.45298462789 f_n 2.45298462789 numgrad 0.0 grad[ix] 0.0
x pos
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73673029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73653029 -0.48088687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (1, 0) f_p 3.87618855154 f_n 3.87618855154 numgrad 0.0 grad[ix] 0.0
x pos
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48078687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48098687 -0.47552459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (1, 1) f_p 3.58634808296 f_n 3.58634808296 numgrad 0.0 grad[ix] 0.0
x pos
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47542459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47562459]
 [-0.27323645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (1, 2) f_p 4.35845575561 f_n 4.35845575561 numgrad 0.0 grad[ix] 0.0
x pos
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27313645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
x neg
[[-0.96735714 -0.02182641  0.25247529]
 [ 0.73663029 -0.48088687 -0.47552459]
 [-0.27333645  0.12538062  0.95374082]
 [-0.56713774 -0.27178229 -0.77748902]
 [-0.59609459  0.7795666   0.19221644]
 [-0.6831809  -0.04200519  0.72904007]
 [ 0.18289107  0.76098587 -0.62245591]
 [-0.61517874  0.5147624  -0.59713884]
 [-0.33867074 -0.80966534 -0.47931635]
 [-0.52629529 -0.78190408  0.33412466]]
ix (2, 0) f_p 3.47506566658 f_n 3.47504183957 numgrad 0.119135048577 grad[ix] 0.0
Gradient check failed.
First gradient error found at index (2, 0)
Your gradient: 0.000000 	 Numerical gradient: 0.119135

Process finished with exit code 0
